%================================================================
% SLO
%----------------------------------------------------------------
% datoteka: 	thesis_template.tex
%
% opis: 		predloga za pisanje diplomskega dela v formatu LaTeX na
% 				Univerza v Ljubljani, Fakulteti za računalništvo in informatiko
%
% pripravili: 	Matej Kristan, Zoran Bosnić, Andrej Čopar,
%			  	po začetni predlogi Gašperja Fijavža
%
% popravil: 	Domen Rački, Jaka Cikač, Matej Kristan
%
% verzija: 		30. september 2016 (dodan razširjeni povzetek)
%================================================================


%================================================================
% SLO: definiraj strukturo dokumenta
% ENG: define file structure
%================================================================
\documentclass[a4paper, 12pt]{book}
 

%================================================================
% SLO: Odkomentiraj "\SLOtrue " za izbiro slovenskega jezika
% ENG: Uncomment "\SLOfalse" to chose English languagge
%================================================================
\newif\ifSLO
\newif\ifTRACKEXIST
\newif\ifTRACKCS
\newif\ifPROGRAMMM

% ---------------------------------------------------------------------------------------
% IMPORTANT: Adjust the thesis language, your study program and course within this block
% ---------------------------------------------------------------------------------------
% switch language
\SLOtrue % Enables Slovenian language
%\SLOfalse  % Enables English language

% switch programs: Computer science and Multimedia. Set to false if the program is in Multimedia
\PROGRAMMMfalse
%\PROGRAMMMtrue

% switch on if your program is divided into tracks CS and DS, otherwise leave it false
% CAUTION: if you were first enrolled into your program before school year 2019/2020, your program is not divided into tracks. In any case, be absolutely sure you select the correct variant. IF IN DOUBT, always contact the student office to advise you.
%
 \TRACKEXISTfalse
%\TRACKEXISTtrue

% default course name is "Computer science" if your course name is "Data science", set the following switch to false
\TRACKCStrue % uncomment if the thesis is from course "Information science"
%\TRACKCSfalse % uncomment if the thesis is from course "Data Science"
% -------------------------------------------------------------------------------------------
% End of language, program and course adjustment
% -------------------------------------------------------------------------------------------


%================================================================
% SLO: vključi oblikovanje in pakete
% ENG: include design and packages
%================================================================
\input{style/thesis_style}

%----------------------------------------------------------------
% |||||||||||||||||||||| USTREZNO POPRAVI |||||||||||||||||||||||
% |||||||||||||||||||||| EDIT ACCORDINGLY |||||||||||||||||||||||
%----------------------------------------------------------------
\newcommand{\ttitle}{Sistem za zagotavljanje zaupanja v dobavni verigi zdravil z uporabo verige blokov}
\newcommand{\ttitleEn}{Trust System in Pharmaceutical Supply Chain Using Blockchain}
\newcommand{\tsubject}{\ttitle}
\newcommand{\tsubjectEn}{\ttitleEn}
\newcommand{\tauthor}{Žan Pižmoht}
\newcommand{\temail}{zp6881@student.uni-lj.si}
\newcommand{\myyear}{2025}
\newcommand{\tkeywords}{zaupanje, tehnologija veriženja blokov, dobavna veriga zdravil}
\newcommand{\tkeywordsEn}{trust, blockchain, pharmaceutical supply chain}
\newcommand{\mysupervisor}{prof.~dr. Vlado Stankovski}
\newcommand{\mycosupervisor}{doc.~dr.\ Petar Kochovski}

% include formatted front pages
\input{style/thesis_front_pages}

%================================================================
% ENG: main pages of the thesis
%================================================================

% Osnutek magistrske naloge v slovenščini
% (Uporabite v svojem LaTeX slogovnem predlogu)

\chapter{Uvod}


\chapter{Pregled literature in ozadje}

\section{Zaupanje}

Pojem zaupanja je temeljni gradnik pri zasnovi našega sistema za farmacevtsko dobavno verigo. Zaupanje je kompleksen, večdimenzionalen in interdisciplinaren koncept, ki ga obravnavajo različne vede. Obravnava se v sociologiji, psihologiji, ekonomiji, računalništvu in še ostalih vedah. Prav zaradi te raznolikosti v literaturi ne obstaja enotna definicija, temveč več pristopov, ki poudarjajo različne vidike \cite{holtmanns2008trust,grandison2000survey}.

\subsection{Definicije zaupanja}
V družboslovnem kontekstu je zaupanje pogosto opredeljeno kot stanje pozitivnih pričakovanj glede dejanj druge osebe v okoliščinah, kjer obstaja določena stopnja tveganja \cite{boon1991interpersonal}. Gambetta \cite{gambetta1988trust} zaupanje definira kot subjektivno verjetnost, da bo agent opravil določeno dejanje, še preden je to mogoče preveriti. Mayer, Davis in Schoorman \cite{mayer1995integrative} pa ga opredelijo kot pripravljenost ene stranke, da se izpostavi ranljivosti glede na dejanja druge stranke, ob pričakovanju, da bo ta delovala v skladu s pričakovanji.

V digitalnem okolju se koncept zaupanja prenaša iz družbenega v tehnični kontekst. Denning \cite{denning1993trust} trdi, da je zaupanje v sistem lastnost, ki jo je mogoče formalno določiti in jo modelirati. Sistem je torej zaupanja vreden, če mu njegovi uporabniki zaupajo glede na opaženo skladnost z vnaprej določenimi standardi. Grandison in Sloman \cite{grandison2000survey} zaupanje obravnavata kot kvalificirano prepričanje zaupnika o kompetentnosti, integriteti, varnosti in zanesljivosti zaupanja vrednega subjekta.

\subsection{Lastnosti zaupanja}

Zaupanje je po svoji naravi večdimenzionalen pojem, ki ga ni mogoče zajeti z eno samo definicijo. V literaturi se ponavlja, da zaupanje vključuje čustvene in vedenjske komponente, ki se med seboj prepletajo in vplivajo na odločanje posameznika ali sistema \cite{mcknight2001trust, karthik2017ontology}. V družbenem kontekstu gre za pripravljenost posameznika, da se izpostavi tveganju na podlagi prepričanja, da bo druga stran delovala predvidljivo in skladno s pričakovanji. V informacijskih sistemih pa to pomeni sposobnost sistema, da sprejema odločitve o sodelovanju na podlagi preteklih izkušenj in ocenjene zanesljivosti entitet.

Zaupanje obstaja le v razmerju med dvema ali več entitetami, kjer ena zaupa drugi v določeni situaciji ali kontekstu. Takšno razmerje je dinamično, saj se lahko stopnja zaupanja sčasoma povečuje ali zmanjšuje. Poleg tega je zaupanje asimetrično: dejstvo, da entiteta A zaupa entiteti B, še ne pomeni, da bo tudi B zaupala A \cite{mayer1995integrative}.

Ena od osrednjih značilnosti zaupanja je njegova povezanost s tveganjem in negotovostjo. Zaupanje je smiselno le v okoliščinah, kjer obstaja možnost, da drugi akter ne bo ravnal skladno s pričakovanji \cite{boon1991interpersonal}. Če bi imeli popoln nadzor ali popolno informacijo, zaupanje sploh ne bi bilo potrebno. V kontekstu varnostnih in distribucijskih sistemov zaupanje dopolnjuje formalne zaščitne mehanizme, kot so avtentikacija in šifriranje, saj omogoča oceno vedenja akterjev tam, kjer tehnični ukrepi ne zadostujejo \cite{denning1993trust}.

Zaupanje je tudi subjektivno in kontekstualno. Različni akterji lahko enake vedenjske vzorce interpretirajo različno, odvisno od svojih ciljev, izkušenj, regulatornih zahtev, prepričanj itn.

\subsection{Atributi zaupanja}
Da bi bilo zaupanje uporabno v digitalnem okolju, ga je potrebno izraziti z merljivimi atributi, ki opisujejo lastnosti ali vedenje zaupanja vrednega subjekta. Ti atributi omogočajo, da se konceptualna ideja zaupanja preslika v formalne modele. V literaturi se pojavljajo različne skupine atributov.

Klasični modeli, kot sta Mayer, Davis in Schoorman \cite{mayer1995integrative} ter McKnight in Chervany \cite{mcknight2001trust}, opredeljujejo tri temeljne dimenzije zaupanja: kompetentnost, integriteto in dobrohotnost. Kompetentnost se nanaša na sposobnost entitete, da učinkovito izvede nalogo, integriteta na njeno zavezanost etičnim in profesionalnim načelom, dobrohotnost pa na odsotnost namere povzročiti škodo. Kasneje so bili tem trem dodani še predvidljivost in zanesljivost, ki poudarjata konsistentnost vedenja skozi čas.

V digitalnih in porazdeljenih okoljih so se pojavili dodatni atributi, ki izhajajo iz tehničnih vidikov zaupanja. Grandison in Sloman \cite{grandison2000survey} zaupanje opišeta kot prepričanje o kompetentnosti, varnosti in verodostojnosti drugega subjekta. Denning \cite{denning1993trust} poudarja, da je zaupanja vrednost sistema mogoče ocenjevati tudi z vidika varnosti, skladnosti s pravili ter preverljivosti delovanja. Ti atributi omogočajo formalno ocenjevanje zaupanja med akterji.

V farmacevtski dobavni verigi imajo atributi zaupanja izrazito regulatorno in sledilno komponento. Uddin in sodelavci \cite{uddin2021blockchain} poudarjajo, da so pri zagotavljanju zaupanja ključni kazalniki sledljivost, pristnost in celovitost podatkov. 
Kayhan in sodelavci \cite{kayhan2022ensuring} izpostavljajo še pomen transparentnosti, nespremenljivosti in izvorne sledljivosti (angl.~\textit{provenance}), ki jih omogoča tehnologija veriženja blokov.

Predstavljeni atributi ne predstavljajo univerzalne množice meril, temveč zbirko značilnosti, ki jih lahko posamezen akter uporabi pri lastni presoji zaupanja. V sistemu, ki je predstavljen v tej nalogi, se atributi uporabljajo predvsem kot podatkovne lastnosti (angl.~\textit{data properties}) v ontologiji. Te omogočajo, da akterji formalno zapišejo svoje kriterije za ocenjevanje drugih entitet. S tem v sistemu omogočamo standardizirano predstavitev vhodnih metrik, ki jih posamezni akterji uporabljajo pri svojem algoritmu za izračunavanje zaupanja.

\section{Upravljanje zaupanja v razpršenih sistemih}
Huaizhi Li in Mukesh Singhal v članku \textit{Trust Management in Distributed Systems} \cite{li2007survey} opredelita upravljanje zaupanja kot proces zbiranja informacij, potrebnih za vzpostavitev zaupanja med entitetami, ter dinamičnega spremljanja in prilagajanja obstoječih razmerij zaupanja. Avtorja poudarjata, da v razpršenih okoljih kot so internet, sistemi enakovrednih entitet (angl. \texttt{peer-to-peer}) in mobilna omrežja ad hoc pogosto sodelujejo entitete, ki se med seboj ne poznajo. Zato zaupanje postane ključni mehanizem za zmanjšanje tveganja in zagotavljanje sodelovanja. Namen sistema za upravljanje zaupanja je ohranjati ažurne in skladne informacije o zaupanju med akterji v omrežju.

\subsection{Dokazni modeli zaupanja}
Dokazni modeli temeljijo na preverljivih dokazih, kot so digitalna potrdila, javni ključi ali kriptografski podpisi. 
Ti pristopi zagotavljajo preverjanje identitete in integritete entitet, ne pa tudi njihove dejanske zanesljivosti. 
Najpogostejša primera sta hierarhični sistem X.509 \cite{housley1999rfc2459} in decentralizirani sistem PGP \cite{elkins2001mime}, kjer se zaupanje posreduje prek verige certifikatov oziroma prek subjektivnih ocen uporabnikov. 
Tak model se uporablja predvsem pri inicializaciji zaupanja in zagotavlja osnovno preverjanje pristnosti brez ocenjevanja vedenja.

\subsection{Priporočilni modeli zaupanja}
Priporočilni modeli gradijo zaupanje na osnovi izkušenj in posredovanih ocen drugih entitet. 
Vsaka entiteta ocenjuje druge glede na pretekle interakcije, te ocene pa se lahko delijo naprej kot priporočila. 
Model uporablja pogojno tranzitivnost zaupanja – entiteta A lahko zaupa entiteti C, če A zaupa B kot priporočitelju in lahko ovrednoti njegovo oceno.

Pri tem se uporablja zvezna vrednost zaupanja $tv_T$ med $0$ in $1$, izračunana iz vrednosti priporočil po poti $A \rightarrow B \rightarrow C \rightarrow D$. 
Za končno vrednost se uporabi zmnožek delnih zaupanj na poti:
\[
tv_T = \prod_{i=1}^{n} \frac{rtv(i)}{4} \times tv(T)
\]
kjer $rtv(i)$ predstavlja stopnjo zaupanja v posameznega posrednika, $tv(T)$ pa končno vrednost zaupanja v ciljno entiteto.  
Če obstaja več poti med akterjema, se končna vrednost določi kot povprečje rezultatov posameznih poti.

\subsection{Porazdeljeno ocenjevanje zaupanja}

V omrežjih enakovrednih akterjev (angl. \textit{peer-to-peer}) se zaupanje ocenjuje decentralizirano. 
Vsako vozlišče vodi lastno evidenco interakcij in vrednoti druge glede na uspešnost sodelovanja. 
Xiong in Liu predlagata metriko, ki temelji na razmerju med pozitivnimi in negativnimi interakcijami:
\[
T(u,t) = \frac{\sum_{v \in P, v \neq u} S(u,v,t) \, Cr(v,t)}{\sum_{v \in P, v \neq u} I(u,v,t)}
\]
kjer $S(u,v,t)$ označuje zadovoljstvo uporabnika $u$ z $v$ do časa $t$, $Cr(v,t)$ je korekcijski faktor za filtriranje povratnih informacij, $I(u,v,t)$ pa število interakcij med $u$ in $v$. 
Rezultat $T(u,t)$ je vedno v intervalu $(0,1)$ in predstavlja trenutno stopnjo zaupanja v entiteto. 
Sistem lahko določi pragove $C_1$ in $C_2$, pri čemer entiteta velja za zaupanja vredno, če velja $I(u,t) > C_1$ in $T(u,t) > C_2$.

Takšni sistemi so učinkoviti pri akumuliranju ocen, vendar občutljivi za napačne ali zlonamerne povratne informacije. 
Zato številne rešitve uvajajo uteževanje priporočil glede na zanesljivost virov ali časovno starost podatkov.

\subsection{Dinamično posodabljanje zaupanja}

Ker se vedenje akterjev sčasoma spreminja, se mora zaupanje prilagajati novim podatkom. 
Posodobitev vrednosti se pogosto izvede z amortizacijskimi ali diskontnimi faktorji, ki dajejo večjo težo nedavnim interakcijam. 
Primer takega mehanizma je izračun nove vrednosti zaupanja po zaključeni interakciji:
\[
T_{\text{new}} = \frac{r + N \, T_{\text{old}} \, e^{-\beta \Delta t}}{1 + N \, e^{-\beta \Delta t}}
\]
kjer $T_{\text{old}}$ predstavlja prejšnjo vrednost zaupanja, $r$ novo oceno po transakciji, $N$ število izvedenih interakcij, $\beta$ faktor dušenja, $\Delta t$ pa čas od zadnje posodobitve. 
Na ta način sistem zagotavlja, da nove izkušnje hitreje vplivajo na oceno, stare pa postopoma izgubijo težo.

\subsection{Povezava z našo rešitvijo}
Predstavljeni modeli zaupanja predstavljajo osnovo za delovanje razvitega sistema. Vsak akter v dobavni verigi lahko uporabi svoj način izračuna zaupanja, ki temelji na dokazih, priporočilih ali dinamičnih metrikah. Sistem ne vsiljuje enotnega algoritma, temveč omogoča, da akter sam oblikuje pravila na podlagi podatkov iz ontologije. Rezultati teh izračunov se shranjujejo v verigo blokov, ki deluje kot skupen in trajen zapis ocen. S tem smo združili različne pristope v enoten sistem, kjer je zaupanje merljivo in preverljivo.


  \subsection{Modeli zaupanja}
\section{Farmacevtske dobavne verige}
  \subsection{Izzivi sledenja in boj proti ponarejanju}
  \subsection{Regulatorni okvir}
\section{Tehnologija veriženja blokov v dobavnih verigah}
  \subsection{Javne in dovoljene verige blokov}
  \subsection{Pametne pogodbe za nadzor dostopa in sledljivost}
\section{Semantični splet in ontološke metode}
  \subsection{RDF, OWL in orodja za ontologijo}
  \subsection{Ontologija zaupanja}
\section{Analiza vrzeli in prispevek te naloge}
\section{Ontologija zaupanja}
  \subsection{Koncepti in odnosi}
  \subsection{SWRL pravila}
  \subsection{Mehanizem razumevanja (angl. Reasoning Mechanism)}
\section{Pametne pogodbe in pametni orakli}

\chapter{Implementacija sistema}

\section{Arhitektura sistema}

Arhitektura sistema za upravljanje zaupanja v farmacevtski dobavni verigi je sestavljena iz več plasti. Te omogočajo kombinacijo semantičnih podatkov, subjektivne ocene zaupanja in decentraliziranega shranjevanja rezultatov v verigo blokov. Z delitvijo sistema na plasti omogočamo modularnost, večjo preglednost in lažjo implementacijo nadaljnjih razširitev.

Arhitekturo razdelimo na tri plasti, katere bodo podrobneje opisane v naslednjih podpoglavjih:

\begin{enumerate}
    \item \textbf{Plast znanja} \\
    V tej plasti se nahajajo vse ontološke definicije, primerki akterjev in njihove lastnosti. Sem spada tudi konceptualna zasnova lastnosti zaupanja, kot so licence, temperaturne nepravilnosti, točnost dostave ipd.

    \item \textbf{Mehanizem za sklepanje zaupanja} \\
    Ta plast vključuje sistem za izvajanje ocenjevanja zaupanja. Združuje podatke iz ontologije in pravil zaupanja ter izvede sklepanje za vsak par entitet. Rezultat je preslikava razmerja zaupanja med akterji, ki je pripravljena za zapis v verigo blokov.

    \item \textbf{Graf zaupanja na verigi blokov} \\
    Zadnja plast predstavlja pametno pogodbo, ki beleži razmerja zaupanja med entitetami. Shranjevanje rezultatov v verigo blokov omogoča transparentnost, trajnost in decentralizirano preverljivost zaupanja. 
\end{enumerate}

\noindent
Na sliki~\ref{fig:architecture-diagram} je prikazan arhitekturni pregled sistema.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{Arhitektura-trust-management.png}
    \caption{Večplastna arhitektura sistema za upravljanje zaupanja}
    \label{fig:architecture-diagram}
\end{figure}

\newpage

\subsection{Plast znanja}
Plast znanja (angl. Knowledge Layer) definira semantično strukturo akterjev, njihove značilnosti in nabor pravil za individualno ocenjevanje zaupanja. V osnovi jo sestavljata dve ključni komponenti: ontologija in pravila zaupanja posameznih akterjev.

\paragraph{Ontologija}
Ontologija v jeziku OWL predstavlja formalno definiran model, ki vključuje vse vrste entitet, ki sodelujejo v farmacevtski dobavni verigi (npr. \textit{Proizvajalec}, \textit{Lekarna}, \textit{Prevoznik}, \textit{Regulator}). Vsaka vrsta entitete ima lahko specifične lastnosti, ki jih sistem uporablja pri sklepanju o zaupanju, kot so na primer:

\begin{itemize}
    \item \texttt{hasDeliveryPunctuality} - točnost dostave,
    \item \texttt{hasTempViolationRate} - stopnja temperaturnih odstopanj,
    \item \texttt{hasLicense} - podatek o veljavni licenci,
    \item \texttt{hasGMP} - skladnost s proizvodnimi standardi GMP \cite{nally2016good},
    \item \texttt{hasAuditScore} - rezultat presoje kakovosti.
\end{itemize}

Ontologija je zapisana v formatu RDF \cite{w3crdfconcepts} zasnovan na označevalnem jeziku XML \cite{w3crdfxml}, ki omogoča enostavno obdelavo s knjižnico \texttt{rdflib} \cite{rdflib} v programskem jeziku Python. Na ta način lahko sklepanje temelji na aktualnih podatkih, zapisanih v ontološkem grafu, brez potrebe po relacijski bazi ali ročnem povezovanju.

Na sliki \ref{fig:ontology-export} vidimo vse akterje v ontologiji predstavljene v programu Protege.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{figures/export-pharma-trust.png}
    \caption{Akterji ontologije v programu Protege}
    \label{fig:ontology-export}
\end{figure}

V ontologiji so definirani tudi posamezni primerki entitet (npr. \textit{Pfizer}, \textit{DHL}, \textit{MediPlus}), skupaj z njihovimi lastnostmi. To omogoča sistemu, da na podlagi resničnih podatkov izvede evalvacijo zaupanja.

\paragraph{Pravila zaupanja posameznih akterjev}

Vsaka entiteta v sistemu lahko definira svoja lastna pravila zaupanja, ki opisujejo pogoje, pod katerimi določena entiteta zaupa drugi. Ta pravila so zapisana v berljivi in strukturirani obliki JSON, kar omogoča enostavno vključevanje v mehanizem sklepanja.

Primer politike pravil zaupanja za entiteto \textit{Pfizer} je prikazan v spodnjem zapisu v formatu JSON:

\begin{verbatim}
{
  "actor": "http://example.org/trust#Pfizer",
  "trusts": {
    "Transporter": {
      "hasDeliveryPunctuality": { "gte": 0.9 },
      "hasTempViolationRate": { "lte": 0.05 }
    }
  }
}
\end{verbatim}

Zapis pove, da entiteta \textit{Pfizer} zaupa samo tistim prevoznikom, ki dosegajo vsaj 90\,\% pravočasnih dostav (\texttt{hasDeliveryPunctuality~$\geq$~0.9}) in katerih delež temperaturnih odstopanj pri transportu zdravil ne presega 5\,\% (\texttt{hasTempViolationRate~$\leq$~0.05}). Na ta način se pravila zaupanja natančno preslikajo v merljive pogoje, ki temeljijo na lastnostih, definiranih v ontologiji.

Mehanizem sklepanja nato uporabi ta pravila za vsako entiteto, s katero obravnavani akter vzpostavi zaupanje ter preveri, ali so pogoji izpolnjeni.

Ker so pravila zapisana v JSON obliki, je možno preprosto razviti uporabniški vmesnik, kjer lahko predstavnik podjetja (npr. administrator lekarne ali regulatorja) preko obrazca določil svoje kriterije za zaupanje. Vmesnik bi generiral JSON strukturo na podlagi definiranih lastnosti v ontologiji. To nam omogoča visoko stopnjo prilagodljivosti in enostavne uporabe brez tehničnega predznanja.

JSON pravila služijo kot most med semantičnim modelom in subjektivno presojo vsakega akterja. Tako omogočamo personalizirano ocenjevanje zaupanja.

\subsection{Mehanizem za sklepanje zaupanja (angl. Trust Resolution Engine)}

Mehanizem za sklepanje zaupanja predstavlja osrednjo logično plast sistema, kjer se združujejo podatki iz ontologije in pravila zaupanja posameznih akterjev. Tukaj se izvede proces ocenjevanja, ki določi, ali določena entiteta zaupa drugi glede na pogoje, zapisane v pravilih zaupanja posameznega akterja.

\paragraph{Delovanje mehanizma}
Python modul, razvit za potrebe sistema, izvaja naslednje korake:
\begin{enumerate}
    \item Naloži ontologijo (OWL/RDF) in iz nje izlušči podatke o vseh akterjih ter njihovih lastnostih.
    \item Prebere pravila zaupanja vsakega akterja, ki so zapisana v JSON formatu.
    \item Za vsak par (ocenjevalec in tisti, ki je ocenjen) preveri, ali vrednosti atributov ocenjenega akterja ustrezajo pravilom ocenjevalca.
    \item Rezultate ocenjevanja shrani v zbirko rezultatov (CSV datoteka) in jih pripravi za zapis v verigo blokov.
\end{enumerate}

\paragraph{Primer ocenjevanja}
Če ima npr. akter \textit{Pfizer} pravilo, da zaupa le prevoznikom z vsaj 90\,\% točnih dostav in manj kot 5\,\% temperaturnih nepravilnostih, bo mehanizem preveril te pogoje za vsakega prevoznika, zapisanega v ontologiji. Rezultat ocenjevanja je binarna vrednost (\texttt{true/false}), ki pove, ali akter izpolnjuje kriterije zaupanja.

\subsection{Graf zaupanja na verigi blokov (angl. Blockchain Trust Registry)}

Zadnja plast arhitekture je namenjena trajnemu in preverljivemu beleženju rezultatov ocenjevanja zaupanja. To dosežemo z uporabo pametne pogodbe na verigi blokov, ki deluje kot decentraliziran register zaupanja (angl. \textit{trust registry}).

\paragraph{Struktura pametne pogodbe}
Pametna pogodba vsebuje podatkovno strukturo, ki beleži relacije zaupanja med akterji v obliki:
\[
    (akter1, akter2) \mapsto status\_zaupanja
\]
kjer je \texttt{status\_zaupanja} logična vrednost (\texttt{true/false}), ki označuje, ali akter 1 zaupa akterju 2.

\paragraph{Funkcionalnosti}
Pametna pogodba omogoča naslednje osnovne funkcije:
\begin{itemize}
    \item \texttt{setTrustStatus()} --- zapis oziroma posodobitev rezultata zaupanja na verigi blokov.
    \item \texttt{isTrusted()} --- preverjanje, ali določen akter zaupa drugemu.
    \item \texttt{event TrustUpdated} --- beleženje dogodkov o spremembi zaupanja za transparentnost in enostavno spremljanje.
\end{itemize}

\section{Orodja in razvojno okolje}
\section{Ontologija in orodja za sklepanje}

\subsection{Ontologija zaupanja}

Ontologija zaupanja je osnovni gradnik sistema, saj omogoča formaliziran opis vseh akterjev v farmacevtski dobavni verigi ter njihovih lastnosti. Zasnovana je v jeziku OWL. Glavni namen ontologije je, da lahko vse akterje opišemo na enoten način in jih obogatimo s podatki, ki so pomembni za ocenjevanje zaupanja.

\subsubsection{Razredi akterjev}

V ontologiji so definirani osnovni razredi, ki predstavljajo tipe akterjev. To so proizvajalec, distributer, lekarna, prevoznik in regulator. Vsi ti razredi so podrazredi splošnega razreda \texttt{Actor}, kar pomeni, da jih lahko obravnavamo skupaj, ko govorimo o celotni verigi. Vsak tip akterja ima svoje značilne lastnosti. Na primer, proizvajalci imajo lastnost \texttt{hasGMP}, ki pove, ali imajo veljavno GMP skladnost, prevozniki imajo lastnosti \texttt{hasDeliveryPunctuality} in \texttt{hasTempViolationRate}, lekarne pa lastnost \texttt{hasPrescriptionComplianceRate}.

\subsubsection{Lastnosti zaupanja}

Lastnosti opisujejo merljive kriterije, ki se uporabljajo pri presoji zaupanja. Nekaj primerov:
\texttt{hasGMP} opisuje ali je proizvajalec skladen z dobrimi proizvodnimi praksami,
\texttt{hasAuditScore} predstavlja oceno presoje kakovosti,
\texttt{hasLicense} označuje, ali ima akter veljavno licenco,
\texttt{hasDeliveryPunctuality} izraža delež pravočasnih dostav,
\texttt{hasTempViolationRate} pove, kolikšen delež transportov je imel temperaturna odstopanja,
\texttt{hasPrescriptionComplianceRate} opisuje skladnost lekarne pri izdaji zdravil na recept,
\texttt{hasIssuedCertifications} je število certifikatov, ki jih je regulator izdal,
\texttt{hasJurisdictionLevel} pa določa raven pristojnosti regulatorja (npr. lokalna, nacionalna, globalna).

\subsubsection{Razredi zaupanja}

Za vsak tip akterja so v ontologiji definirani tudi posebni razredi, ki predstavljajo zaupanja vredne entitete. To so na primer \texttt{TrustedManufacturer}, \texttt{TrustedDistributor}, \texttt{TrustedPharmacy}, itn. Ti razredi so definirani z ekvivalenčnimi pogoji, kar pomeni, da reasoner lahko samodejno uvrsti entiteto v določen zaupanja vreden razred, če so pogoji izpolnjeni. Na primer, proizvajalec, ki ima GMP certifikat in dovolj visoko oceno presoje kakovosti, bo klasificiran kot \texttt{TrustedManufacturer}. Podobno velja za druge tipe akterjev.

\subsubsection{Primerki akterjev}

V ontologijo so dodani tudi konkretni primerki, ki predstavljajo dejanske akterje v sistemu. Tako imamo na primer proizvajalca Pfizer in Novartis, prevoznika DHL, lekarno MediPlus, distributerja EuroLogistics ter regulatorja EMA. Vsak od teh primerkov ima določene lastnosti, kot so na primer ocena presoje, točnost dostave ali število izdanih certifikatov. Te vrednosti se potem uporabijo pri sklepanju o zaupanju.

\subsection{Primer toka podatkov in logike}

Za ponazoritev delovanja si oglejmo primer, kjer proizvajalec Pfizer ocenjuje prevoznika DHL:

\begin{enumerate}
  \item \textbf{Ontologija (OWL)}: v ontologiji so zabeležene lastnosti prevoznika DHL, npr.\ \texttt{hasDeliveryPunctuality = 0.95} in \texttt{hasTempViolationRate = 0.02}.
  \item \textbf{Pravila zaupanja}: Pfizerjeva politika zaupanja za razred \textit{Transporter} zahteva \texttt{hasDeliveryPunctuality $\geq$ 0.90} in \texttt{hasTempViolationRate $\leq$ 0.05}.
  \item \textbf{Sklepanje (Python)}: mehanizem prebere lastnosti DHL iz ontologije in jih primerja s Pfizerjevimi pogoji. Ker sta oba pogoja izpolnjena, rezultat sklepanja je \texttt{true}.
  \item \textbf{Zapis v verigo blokov}: rezultat (\texttt{Pfizer} zaupa \texttt{DHL}) se zapiše v pametno pogodbo. Funkcija \texttt{isTrusted(Pfizer, DHL)} nato vrne \texttt{true}.
\end{enumerate}

Na ta način sistem poveže semantične podatke, subjektivna pravila in trajne zapise rezultatov v verigi blokov v enoten potek.

\subsection{Način posodabljanja blockchain registra}

Zapis rezultatov v pametno pogodbo se lahko sproži na tri načine:
\begin{itemize}
  \item \textbf{Ročno}: prek CLI ali uporabniškega vmesnika, primerno za prezentacije in testne scenarije.
  \item \textbf{Dogodkovno}: ob spremembi entitete, pravil ali metrik v ontologiji (npr.\ nova licenca, posodobljen audit).
  \item \textbf{Periodično}: v rednih intervalih (npr.\ dnevno), pri čemer se zapis izvrši le ob spremembi rezultata glede na prejšnje stanje.
\end{itemize}


\section{Razvoj pametnih pogodb in oraklov}
\section{Uporabniški vmesnik in API-ji}

\chapter{Evalvacija}
\section{Varnostna analiza}
\section{Zmogljivost in razširljivost}
\section{Natančnost ocene zaupanja}
\section{Prednosti in omejitve}
\section{Primerjava z obstoječimi rešitvami}
\section{Pridobljena spoznanja}

\chapter{Zaključek in nadaljnje delo}
\section{Povzetek prispevkov}
\section{Nadaljnje raziskave}

\appendix
\chapter{Shema ontologije in SWRL pravila}
\chapter{Izvlečki kode pametnih pogodb}

%----------------------------------------------------------------
% SLO: bibliografija
% ENG: bibliography
%----------------------------------------------------------------
\bibliographystyle{elsarticle-num}

%----------------------------------------------------------------
% SLO: odkomentiraj za uporabo zunanje datoteke .bib (ne pozabi je potem prevesti!)
% ENG: uncomment to use .bib file (don't forget to compile it!)
%----------------------------------------------------------------
\bibliography{bibliography}

%----------------------------------------------------------------
% SLO: zakomentiraj spodnji del, če uporabljaš zunanjo .bib datoteko
% ENG: comment the part below if using the .bib file
%----------------------------------------------------------------

%\begin{thebibliography}{99}
%\bibitem{Fortnow} L.\ Fortnow, ``Viewpoint: Time for computer science to grow up'',
%{\it Communications of the ACM}, št.\ 52, zv.\ 8, str.\ 33--35, 2009.
%\bibitem{Knuth} D.\ E.\ Knuth, P. Bendix. ``Simple word problems in universal algebras'', v zborniku: Computational Problems in Abstract Algebra (ur. J. Leech), 1970, str. 263--297.
%\bibitem{Lamport} L.\ Lamport. {\it LaTEX: A Document Preparation System}. Addison-Wesley, 1986.
%\bibitem{ubi} O.\ Patashnik (1998) \BibTeX{}ing.
%Dostopno na: \url{http://ftp.univie.ac.at/packages/tex/biblio/bibtex/contrib/doc/btxdoc.pdf}
%\bibitem{licence} licence-cc.pdf. Dostopno na: \url{https://ucilnica.fri.uni-lj.si/course/view.php?id=274}
%\end{thebibliography}

\end{document}
